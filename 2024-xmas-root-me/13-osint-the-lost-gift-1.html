<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="robots" content="index, follow">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>XMAS root-me challenges, The lost gift</title>
        <meta name="description" content="">
        <meta name="keywords" content="ctf, security, root-me, xmas, OSINT , the lost gift, write-up">
        <meta name="author" content="Antoine Benevaut">

        <meta property="og:type" content="website">
        <meta property="og:url" content="https://www.abenevaut.dev/2024-xmas-root-me/13-osint-the-loft-gift-1.html">
        <meta property="og:title" content="XMAS root-me challenges, The lost gift">
        <meta property="og:description" content="">
        <meta property="og:image" content="https://www.abenevaut.dev/images/abenevaut-og-xms-2024-root-me.webp">

        <meta property="twitter:card" content="summary_large_image">
        <meta name=”twitter:creator” content=”@abenevaut”>
        <meta property="twitter:url" content="https://www.abenevaut.dev/2024-xmas-root-me/13-osint-the-loft-gift-1.html">
        <meta property="twitter:title" content="XMAS root-me challenges, The lost gift">
        <meta property="twitter:description" content="">
        <meta property="twitter:image" content="https://www.abenevaut.dev/images/abenevaut-og-xms-2024-root-me.webp">
        <meta property="twitter:image:alt" content="">

        <base href="/"> <!-- /dev.abenevaut/abenevaut/dist/ -->
        <link rel="canonical" href="https://www.abenevaut.dev/2024-xmas-root-me/13-osint-the-loft-gift-1.html" />
        <link rel="manifest" href="manifest.webmanifest" crossorigin="use-credentials" />
        <script src="registerSW.js"></script>

            <script>
      window.article = "<a href=\"#write-up-the-lost-gift\"><h1 id='write-up-the-lost-gift'>Write-up The lost gift<\/h1><\/a>\n<p><img src=\"images\/ctf-2024-rootme-xmas\/osint-the-lost-gift-clue.jpg.webp\" alt=\"Indice, une photo de la rue \u00e0 retrouver\" \/><\/p>\n<blockquote>\n<p>I couldn't wait and opened one of my christmas presents in advance, my very first FPV drone, I had been eagerly waiting for it. I decided to try it outside, conditions were perfect: sunny, no wind and a safe spot for a maiden flight.\nHowever, shortly after takeoff, my drone flied straight ahead and stopped responding to any of my commands. I saw it disappear in a distance, soaring over the trees, completely out of control. I forgot to activate the FailSafe mode...\nFortunately, I still have the last coordinates from the beacon signal transmitted via Wi-Fi and the last image captured by the video feed.\nCould you use these clues to locate my drone?<\/p>\n<\/blockquote>\n<p>Les coordonn\u00e9es sont disponibles dans ce fichiers <a href=\"images\/ctf-2024-rootme-xmas\/osint-the-lost-gift-beacon.pcap.zip\">beacon.pcap<\/a>, et on se les affiche tout de suite\u00a0:<\/p>\n<p><img src=\"images\/ctf-2024-rootme-xmas\/osint-the-lost-gift-get-coordinates-with-wireshark.png.webp\" alt=\"Trouver les coordonn\u00e9s dans wireshark\" \/><\/p>\n<p>Ni la visualisation, ni la manipulation des donn\u00e9es sur wireshark n'est pratique, exportons les donn\u00e9es &quot;File&quot; &gt; &quot;Export\u00a0packet\u00a0dissections&quot; &gt; &quot;As\u00a0Plain\u00a0Text...&quot;.<\/p>\n<p>Avec les param\u00e8tres suivants qui suivent, on obtient un fichier texte exploitable\u00a0:<\/p>\n<p><img src=\"images\/ctf-2024-rootme-xmas\/osint-the-lost-gift-get-coordinates-with-wireshark-export.png.webp\" alt=\"Exporter les coordonn\u00e9s depuis wireshark\" \/><\/p>\n<p>Super! On a une liste de coordonn\u00e9es, mais comment les exploiter\u00a0?<\/p>\n<p>On peut les coller dans un outil de cartographie en ligne. Souvent limit\u00e9 \u00e0 un champ de d\u00e9part et un d'arriv\u00e9.\nGoogle maps tire son \u00e9pingle du jeu avec plusieurs champs possible et on peut renseigner &quot;Latitude,Longitude&quot; comme destination mais dans notre cas on recherche des points au dessus de l'eau et l'outil ne cr\u00e9e pas d'itin\u00e9raire.<\/p>\n<p>Une petite discussion avec ChatGPT qui nous sugg\u00e8re Google Earth, et il va m\u00eame plus loin en nous proposant d'utiliser le type de fichier &quot;KML&quot; pour importer les coordonn\u00e9es.\nAttention, cette fois-ci c'est &quot;Longitude,Latitude&quot; pour les coordonn\u00e9es.<\/p>\n<pre><code class=\"language-kml\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;kml xmlns=&quot;http:\/\/www.opengis.net\/kml\/2.2&quot;&gt;\n  &lt;Document&gt;\n    &lt;name&gt;Trajet&lt;\/name&gt;\n    &lt;Placemark&gt;\n      &lt;name&gt;Mon Trajet&lt;\/name&gt;\n      &lt;LineString&gt;\n        &lt;tessellate&gt;1&lt;\/tessellate&gt;\n        &lt;coordinates&gt;\n          -2.17719,48.02088\n          -2.17733,48.02078\n          -2.17740,48.02073\n          -2.17751,48.02064\n          -2.17758,48.02060\n          -2.17768,48.02054\n          -2.17779,48.02046\n          -2.17795,48.02036\n          -2.17809,48.02029\n          -2.17821,48.02020\n          -2.17829,48.02013\n          -2.17825,48.02001\n          -2.17821,48.01993\n          -2.17815,48.01977\n          -2.17829,48.01960\n          -2.17831,48.01941\n          -2.17833,48.01929\n          -2.17829,48.01918\n          -2.17821,48.01909\n          -2.17804,48.01906\n          -2.17776,48.01858\n          -2.17744,48.01811\n          -2.17711,48.01751\n          -2.17692,48.01727\n          -2.17596,48.01625\n        &lt;\/coordinates&gt;\n      &lt;\/LineString&gt;\n    &lt;\/Placemark&gt;\n  &lt;\/Document&gt;\n&lt;\/kml&gt;\n<\/code><\/pre>\n<p>Une fois import\u00e9, on peut voir le parcours du drone.<\/p>\n<p><img src=\"images\/ctf-2024-rootme-xmas\/osint-the-lost-gift-google-earth.png.webp\" alt=\"Visualiser le trajet du drone sur google earth\" \/><\/p>\n<p>Google Earth dispose d'un outil &quot;r\u00e8gle&quot; qui permet de mesurer la distance entre deux points, ce qui place un trait sur la carte.\nOn peut ensuite suivre ce trac\u00e9 et identifier les points d'arriv\u00e9s qui ressemblent \u00e0 la photo. On cherche les carrefours avec plusieurs routes.<\/p>\n<p><img src=\"images\/ctf-2024-rootme-xmas\/osint-the-lost-gift-google-earth-expected-traject.png.webp\" alt=\"Hypoth\u00e8se du trajet du drone\" \/><\/p>\n<p>Tant qu'on y est, on se donne des id\u00e9es pour une prochaine fois\u00a0:<\/p>\n<ul>\n<li>avec l'outil &quot;Polygon&quot; on peut d\u00e9limiter des zones de recherche<\/li>\n<li>on peut passer la carte en 3D pour apercevoir les reliefs et essayer de retrouver des points de rep\u00e8res<\/li>\n<\/ul>\n<p><img src=\"images\/ctf-2024-rootme-xmas\/osint-the-lost-gift-google-earth-zoom-as-2D.png.webp\" alt=\"\" \/><\/p>\n<p>On peut enfin passer en street view pour voir les d\u00e9tails de la rue.<\/p>\n<p>\ud83c\udf85Hohoho! On a trouv\u00e9 le lieu de la photo.<\/p>\n<p><img src=\"images\/ctf-2024-rootme-xmas\/osint-the-lost-gift-google-earth-flag.png.webp\" alt=\"Le carrefour \u00e0 retrouver\" \/><\/p>\n<p>Pour la post\u00e9rit\u00e9, on peut sauvegarder le lieu sur la map.<\/p>\n<p><img src=\"images\/ctf-2024-rootme-xmas\/osint-the-lost-gift-google-earth-flag-saved.png.webp\" alt=\"Enregistrement de la position du flag avec un marqueur\" \/><\/p>\n<p>\ud83c\udf81Dernier challenge, composer le flag avec le bon nom de rue <code>RM{streetnamewherethedronelanded}<\/code> \ud83c\udfc1<\/p>\n<p>Cr\u00e9dits du challenge <a href=\"https:\/\/x.com\/rootme_org\/status\/1863296339183796546\">root-me.org<\/a> et son auteur <a href=\"https:\/\/chic0s.fr\">Chic0s<\/a><\/p>\n<p><a href=\"2024-xmas-root-me.html\">Sommaire &gt;<\/a><\/p>\n"
    </script>
    <script type="module" src="assets/Article.js"></script>

        <link rel="preconnect" href="https://fonts.bunny.net">
        <link rel="stylesheet" href="assets/app.css">
        <link rel="shortcut icon" href="assets/app-icon.webp" type="image/webp">
    </head>
    <body class="font-sans antialiased">
        <div id="root"></div>
    </body>
</html>
